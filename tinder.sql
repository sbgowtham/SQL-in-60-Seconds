CREATE TABLE SWIPES (
    USER_ID INT,
    TARGET_USER_ID INT,
    SWIPE_DATE DATE
);

CREATE TABLE MATCHES (
    USER_ID INT,
    TARGET_USER_ID INT
);

INSERT INTO SWIPES (USER_ID, TARGET_USER_ID, SWIPE_DATE) VALUES
(101, 202, '2024-12-10'),
(202, 101, '2024-12-11'),
(103, 204, '2024-12-12'),
(204, 103, '2024-12-13'),
(105, 206, '2024-12-14'),
(206, 105, '2024-12-15'),
(101, 103, '2024-12-16');  -- One-way swipe

INSERT INTO MATCHES (USER_ID, TARGET_USER_ID) VALUES
(105, 206),
(206, 105);

SELECT 
    s.USER_ID, 
    s.TARGET_USER_ID
FROM SWIPES s
JOIN SWIPES t 
    ON s.USER_ID = t.TARGET_USER_ID 
   AND s.TARGET_USER_ID = t.USER_ID
LEFT JOIN MATCHES m
    ON s.USER_ID = m.USER_ID AND s.TARGET_USER_ID = m.TARGET_USER_ID
WHERE m.USER_ID IS NULL;
